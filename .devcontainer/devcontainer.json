{
	"name": "OSS Search Package Dev Container",
	"image": "mcr.microsoft.com/devcontainers/base:ubuntu",
	
	"features": {
		"ghcr.io/devcontainers/features/docker-in-docker:2": {
			"version": "latest",
			"dockerDashComposeVersion": "v2"
		},
		"ghcr.io/devcontainers/features/node:1": {
			"version": "20"
		},
		"ghcr.io/devcontainers/features/python:1": {
			"version": "3.11"
		}
	},

	"mounts": [
		"source=/home/skadam/git/oss-search-package,target=/workspace,type=bind,consistency=cached",
		"source=/home/skadam/.kube,target=/home/vscode/.kube,type=bind,consistency=cached"
	],

	"postCreateCommand": "bash -c 'mkdir -p ~/.local/bin && if [ -f ~/.kube/config ]; then chmod 600 ~/.kube/config; fi && curl -LO \"https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl\" && chmod +x kubectl && mv kubectl ~/.local/bin/ && export PATH=\"$HOME/.local/bin:$PATH\" && kubectl version --client && echo \"Dev container ready! Docker and kubectl are available.\"'",

	"customizations": {
		"vscode": {
			"extensions": [
				"ms-python.python",
				"ms-python.vscode-pylance",
				"dbaeumer.vscode-eslint",
				"esbenp.prettier-vscode",
				"ms-kubernetes-tools.vscode-kubernetes-tools",
				"ms-azuretools.vscode-docker"
			],
			"settings": {
				"python.defaultInterpreterPath": "/usr/local/bin/python",
				"python.linting.enabled": true,
				"python.linting.pylintEnabled": false,
				"python.formatting.provider": "black",
				"editor.formatOnSave": true,
				"editor.codeActionsOnSave": {
					"source.fixAll.eslint": "explicit"
				}
			}
		}
	},

	"remoteUser": "vscode",
	"remoteEnv": {
		"DOCKER_BUILDKIT": "1"
	},

	"forwardPorts": [3000, 8000, 8080],

	"workspaceFolder": "/workspace"
}
